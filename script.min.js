function preloadQRImages(){["WechatIMG363.jpg","3591759208694_.pic.jpg","3601759208695_.pic.jpg","3581759208690_.pic.jpg","3611759208695_.pic.jpg"].forEach(e=>{(new Image).src=e,console.log("预加载二维码图片：",e)})}function initFixedCustomerService(){let e=document.querySelector(".fixed-service-btn");e&&(e.addEventListener("click",function(e){e.preventDefault(),this.style.transform="scale(0.95)",setTimeout(()=>{this.style.transform=""},150),openCustomerService()}),e.addEventListener("mouseenter",function(){this.style.transform="translateY(-2px) scale(1.05)"}),e.addEventListener("mouseleave",function(){this.style.transform=""}),setInterval(()=>{document.querySelector(".service-overlay")?e.style.animation="":e.style.animation="pulse 2s infinite"},3e3),console.log("固定客服按钮初始化完成"))}function initAttractionChart(){var e=document.getElementById("attractionChart");e&&new Chart(e,{type:"line",data:{labels:["周一","周二","周三","周四","周五","周六","周日"],datasets:[{label:"魅力指数",data:[8.2,8.5,8.8,9.1,9.3,9.6,9.8],borderColor:"#e91e63",backgroundColor:"rgba(233, 30, 99, 0.1)",borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"#e91e63",pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:6,pointHoverRadius:8},{label:"关注度",data:[6.5,7.2,7.8,8.1,8.4,8.7,9],borderColor:"#ff69b4",backgroundColor:"rgba(255, 105, 180, 0.1)",borderWidth:3,fill:!0,tension:.4,pointBackgroundColor:"#ff69b4",pointBorderColor:"#fff",pointBorderWidth:2,pointRadius:6,pointHoverRadius:8}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"top",labels:{usePointStyle:!0,padding:20,font:{size:12,weight:"500"}}}},scales:{y:{beginAtZero:!1,min:5,max:10,grid:{color:"rgba(0, 0, 0, 0.1)",drawBorder:!1},ticks:{color:"#666",font:{size:11}}},x:{grid:{display:!1},ticks:{color:"#666",font:{size:11}}}},interaction:{intersect:!1,mode:"index"},animation:{duration:2e3,easing:"easeInOutQuart"}}})}function initPaymentFeatures(){let t=document.querySelectorAll(".amount-btn"),o=document.getElementById("amount");document.querySelector(".status-indicator");let n=document.getElementById("customAmount"),i=document.getElementById("setCustomAmount");t.forEach(e=>{e.addEventListener("click",function(){let e=parseFloat(this.getAttribute("data-amount"));o.textContent=e.toFixed(2),t.forEach(e=>e.classList.remove("active")),this.classList.add("active"),updateMainQRCode(e),setTimeout(()=>{showQRPopup(e)},50)})}),i&&i.addEventListener("click",function(){let e=parseFloat(n.value);e&&0<e&&(o.textContent=e.toFixed(2),t.forEach(e=>e.classList.remove("active")),updateMainQRCode(e),setTimeout(()=>{showQRPopup(e)},50))}),n&&n.addEventListener("keypress",function(e){"Enter"===e.key&&i&&i.click()}),setInterval(()=>{var e;"0.00"!==o.textContent&&updatePaymentStatus((e=["等待支付","扫描中...","支付中...","支付成功"])[Math.floor(Math.random()*e.length)])},5e3)}function updatePaymentStatus(e){var t=document.querySelector(".status-indicator span"),o=document.querySelector(".status-indicator i");t&&(t.textContent=e),o&&(e.includes("成功")?(o.style.color="#4caf50",o.className="fas fa-check-circle"):e.includes("支付中")||e.includes("扫描中")?(o.style.color="#ff9800",o.className="fas fa-spinner fa-spin"):(o.style.color="#ffa726",o.className="fas fa-circle"))}function updateMainQRCode(t){let o=document.querySelector(".qr-image");if(o){let e={5.88:"WechatIMG363.jpg",8.88:"3591759208694_.pic.jpg",10.88:"3601759208695_.pic.jpg",16.88:"3581759208690_.pic.jpg",28.88:"3611759208695_.pic.jpg"}[t]||"3591759208694_.pic.jpg";t=new Image;t.onload=function(){o.src=e,console.log("主页面二维码已更新为：",e),o.style.transform="scale(1.05)",o.style.boxShadow="0 4px 15px rgba(233, 30, 99, 0.4)",setTimeout(()=>{o.style.transform="scale(1)",o.style.boxShadow="0 2px 8px rgba(255, 182, 193, 0.3)"},300)},t.src=e}}function updateQRCode(e){updateMainQRCode(e),showAmountConfirmation(e)}function generateWechatQRCode(e){console.log(`正在切换到金额为 ¥${e} 的微信支付二维码...`);var t={5.88:"WechatIMG363.jpg",8.88:"3591759208694_.pic.jpg",10.88:"3601759208695_.pic.jpg",16.88:"3581759208690_.pic.jpg",28.88:"3611759208695_.pic.jpg"},o=document.querySelector(".qr-image");t[e]?(o.src=t[e],showQuickStatus(`¥${e} 二维码已切换`)):showQRSetupInstructions(e)}function showQuickStatus(e){let t=document.createElement("div");t.className="quick-status",t.innerHTML=`
        <div style="
            position: fixed;
            top: 20px;
            right: 20px;
            background: #e91e63;
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 6px;
            z-index: 2000;
            font-weight: 600;
            font-size: 0.9rem;
            box-shadow: 0 2px 8px rgba(233, 30, 99, 0.3);
            animation: slideIn 0.2s ease-out;
        ">
            ${e}
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1e3)}function showQRSetupInstructions(e){var t=document.createElement("div");t.className="qr-setup-instructions",t.innerHTML=`
        <div style="
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            color: #333;
            padding: 2rem;
            border-radius: 10px;
            z-index: 3000;
            font-weight: 500;
            text-align: center;
            min-width: 300px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid #e91e63;
        ">
            <div style="margin-bottom: 1rem; font-size: 1.2rem; color: #e91e63;">📱 设置说明</div>
            <div style="margin-bottom: 1rem;">
                要为 ¥${e} 设置专用二维码：
            </div>
            <div style="text-align: left; margin-bottom: 1rem;">
                1. 打开微信，点击"+"号<br>
                2. 选择"收付款"<br>
                3. 选择"二维码收款"<br>
                4. 设置金额为 ¥${e}<br>
                5. 保存二维码图片<br>
                6. 将图片命名为 wechat-qr-${e}.png
            </div>
            <button onclick="this.parentElement.parentElement.remove()" style="
                background: #e91e63;
                color: white;
                border: none;
                padding: 0.8rem 1.5rem;
                border-radius: 5px;
                cursor: pointer;
                font-weight: 600;
            ">我知道了</button>
        </div>
    `,document.body.appendChild(t)}function showQRGenerationStatus(e){let t=document.createElement("div");t.className="qr-generation-status",t.innerHTML=`
        <div style="
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1.5rem 2rem;
            border-radius: 10px;
            z-index: 2000;
            font-weight: 600;
            text-align: center;
            min-width: 200px;
        ">
            <div style="margin-bottom: 0.5rem;">🔄</div>
            <div>${e}</div>
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},2e3)}function showAmountConfirmation(e){let t=document.createElement("div");t.className="amount-confirmation",t.innerHTML=`
        <div style="
            position: fixed;
            top: 20px;
            right: 20px;
            background: #e91e63;
            color: white;
            padding: 0.8rem 1.2rem;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(233, 30, 99, 0.3);
            z-index: 1000;
            font-weight: 600;
            font-size: 0.9rem;
            animation: slideIn 0.2s ease-out;
        ">
            💰 ¥${e}
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},1500)}function addAnimations(){animateNumbers(),addCardHoverEffects(),addPageLoadAnimations()}function animateNumbers(){var e=document.querySelectorAll(".stat-number");let n=new IntersectionObserver(e=>{e.forEach(e=>{var t,o;e.isIntersecting&&(o=(t=(e=e.target).textContent).includes("%"),animateValue(e,0,parseInt(t.replace(/[^\d]/g,"")),2e3,o),n.unobserve(e))})});e.forEach(e=>n.observe(e))}function animateValue(n,i,a,s,r=!1){let l=performance.now();requestAnimationFrame(function e(t){var t=t-l,t=Math.min(t/s,1),o=Math.floor(i+(a-i)*t);n.textContent=r?o+"%":o.toLocaleString(),t<1&&requestAnimationFrame(e)})}function addCardHoverEffects(){document.querySelectorAll(".stat-card, .beauty-card, .qr-container").forEach(e=>{e.addEventListener("mouseenter",function(){this.style.transform="translateY(-5px) scale(1.02)"}),e.addEventListener("mouseleave",function(){this.style.transform="translateY(0) scale(1)"})})}function addPageLoadAnimations(){document.querySelectorAll(".left-panel, .right-panel").forEach((e,t)=>{e.style.opacity="0",e.style.transform="translateX("+(0===t?"-50px":"50px")+")",setTimeout(()=>{e.style.transition="all 0.8s ease-out",e.style.opacity="1",e.style.transform="translateX(0)"},200*t)})}function addExtraFeatures(){var e=document.querySelector(".qr-image");e&&e.addEventListener("click",function(){this.style.transform="scale(1.2)",setTimeout(()=>{this.style.transform="scale(1)"},300)});let i=document.querySelector(".main-img"),a=document.querySelectorAll(".thumbnail");if(i&&0<a.length){let o=["beauty-1.jpg","beauty-2.jpg","beauty-3.jpg","beauty-4.jpg","beauty-5.jpg"],n=0;a.forEach((e,t)=>{e.addEventListener("click",function(){n=t,i.src=o[n],a.forEach(e=>e.classList.remove("active")),this.classList.add("active"),i.style.transform="scale(0.95)",setTimeout(()=>{i.style.transform="scale(1.05)",setTimeout(()=>{i.style.transform="scale(1)"},150)},150)})}),i.addEventListener("click",function(){n=(n+1)%o.length,this.src=o[n],a.forEach(e=>e.classList.remove("active")),a[n].classList.add("active"),this.style.transform="scale(0.95)",setTimeout(()=>{this.style.transform="scale(1.05)",setTimeout(()=>{this.style.transform="scale(1)"},150)},150)}),setInterval(()=>{n=(n+1)%o.length,i.src=o[n],a.forEach(e=>e.classList.remove("active")),a[n].classList.add("active")},5e3)}}window.addEventListener("error",function(e){console.log("检测到错误，但继续运行:",e.message)}),window.addEventListener("unhandledrejection",function(e){console.log("检测到未处理的Promise拒绝，但继续运行:",e.reason)}),document.addEventListener("DOMContentLoaded",function(){console.log("DOM加载完成，开始初始化"),preloadQRImages(),initFixedCustomerService();var e=document.querySelector('button[style*="position: fixed"][style*="top: 10px"][style*="left: 10px"]');e&&(e.remove(),console.log("已删除现有的测试按钮")),document.querySelectorAll('[class*="mobile"], [id*="mobile"], [class*="banner"]').forEach(e=>{(e.textContent.includes("手机用户")||e.textContent.includes("7.88")||e.textContent.includes("额外减"))&&(e.remove(),console.log("已删除移动端弹窗:",e))});document.querySelectorAll("*").forEach(e=>{e.textContent&&(e.textContent.includes("手机用户专享")||e.textContent.includes("额外减¥1")||e.textContent.includes("仅需¥7.88"))&&(e.remove(),console.log("已删除包含移动端优惠文本的元素:",e))}),initPaymentFeatures(),addAnimations(),initMarketingFeatures(),startCountdown(),initFeedbackCarousel(),console.log("立即初始化历史评价..."),initHistoricalFeedback(),console.log("立即初始化今日评价..."),initTodayFeedback(),setTimeout(()=>{console.log("快速检查历史评价...");var e=document.getElementById("historicalTrack"),e=(e&&e.children.length<10&&(console.log("检测到历史评价数量不足，强制重新生成"),initHistoricalFeedback()),console.log("快速检查今日评价..."),document.getElementById("todayTrack"));e&&e.children.length<10&&(console.log("检测到今日评价数量不足，强制重新生成"),initTodayFeedback())},500),console.log("初始化欢迎按钮点击事件...");e=document.querySelector(".welcome-btn");e?(console.log("找到欢迎按钮，绑定事件监听器"),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("欢迎按钮被点击（事件监听器）"),closeWelcome()}),e.addEventListener("touchend",function(e){e.preventDefault(),e.stopPropagation(),console.log("欢迎按钮被触摸（触摸事件）"),closeWelcome()})):(console.log("未找到欢迎按钮，尝试延迟查找"),setTimeout(()=>{var e=document.querySelector(".welcome-btn");e&&(console.log("延迟找到欢迎按钮"),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("欢迎按钮被点击（延迟绑定）"),closeWelcome()}))},1e3)),window.closeWelcome=closeWelcome,document.addEventListener("click",function(e){e.target&&e.target.classList.contains("welcome-btn")&&(console.log("备用点击处理机制触发"),e.preventDefault(),e.stopPropagation(),closeWelcome())}),document.addEventListener("keydown",function(e){"Enter"!==e.key&&" "!==e.key||(e=document.getElementById("welcomePopup"))&&"none"!==e.style.display&&(console.log("键盘事件触发关闭弹窗"),closeWelcome())}),setTimeout(()=>{var e,t=document.querySelector(".welcome-btn");t&&!t.hasAttribute("data-initialized")&&(console.log("超时保障机制：重新初始化按钮"),t.setAttribute("data-initialized","true"),e=t.cloneNode(!0),t.parentNode.replaceChild(e,t),e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),console.log("超时保障机制：按钮被点击"),closeWelcome()}))},5e3)});let style=document.createElement("style");function copyQQ(){let e="3472132884";navigator.clipboard&&window.isSecureContext?navigator.clipboard.writeText(e).then(()=>{showCopySuccess("QQ号已复制到剪贴板！")}).catch(()=>{fallbackCopy(e)}):fallbackCopy(e)}function fallbackCopy(t){var e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-999999px",e.style.top="-999999px",document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy"),showCopySuccess("QQ号已复制到剪贴板！")}catch(e){showCopyError("复制失败，请手动复制："+t)}document.body.removeChild(e)}function showCopySuccess(e){let t=document.createElement("div");t.className="copy-success",t.innerHTML=`
        <div style="
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            z-index: 3000;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            animation: slideIn 0.3s ease-out;
        ">
            ✅ ${e}
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},3e3)}function showCopyError(e){let t=document.createElement("div");t.className="copy-error",t.innerHTML=`
        <div style="
            position: fixed;
            top: 20px;
            right: 20px;
            background: #f44336;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            z-index: 3000;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(244, 67, 54, 0.3);
            animation: slideIn 0.3s ease-out;
        ">
            ❌ ${e}
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},5e3)}function showOrderSection(e,t){let o=document.getElementById("orderSection");var n=document.getElementById("orderAmount"),i=document.getElementById("orderPackage");o&&n&&i&&(n.textContent=e+".00",i.textContent=t,o.style.display="block",o.style.opacity="0",o.style.transform="translateY(20px)",setTimeout(()=>{o.style.transition="all 0.3s ease",o.style.opacity="1",o.style.transform="translateY(0)"},100))}function createOrder(){showOrderConfirmation(document.getElementById("orderAmount").textContent,document.getElementById("orderPackage").textContent),showOrderStatus("正在创建订单..."),setTimeout(()=>{showOrderStatus("订单创建成功！"),setTimeout(()=>{showWechatPayRedirect()},1500)},2e3)}function showOrderConfirmation(e,t){var o=document.createElement("div");o.className="order-confirmation",o.innerHTML=`
        <div style="
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            color: #333;
            padding: 2rem;
            border-radius: 12px;
            z-index: 3000;
            font-weight: 500;
            text-align: center;
            min-width: 300px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid #e91e63;
        ">
            <div style="margin-bottom: 1rem; font-size: 1.2rem; color: #e91e63;">🛒 订单确认</div>
            <div style="margin-bottom: 1rem;">
                <strong>金额：</strong>¥${e}<br>
                <strong>套餐：</strong>${t}
            </div>
            <div style="margin-bottom: 1rem; color: #666; font-size: 0.9rem;">
                点击确认后将跳转到微信支付
            </div>
            <button onclick="this.parentElement.parentElement.remove()" style="
                background: #e91e63;
                color: white;
                border: none;
                padding: 0.8rem 1.5rem;
                border-radius: 6px;
                cursor: pointer;
                font-weight: 600;
                margin-right: 0.5rem;
            ">确认下单</button>
            <button onclick="this.parentElement.parentElement.remove()" style="
                background: #ccc;
                color: white;
                border: none;
                padding: 0.8rem 1.5rem;
                border-radius: 6px;
                cursor: pointer;
                font-weight: 600;
            ">取消</button>
        </div>
    `,document.body.appendChild(o)}function showOrderStatus(e){let t=document.createElement("div");t.className="order-status",t.innerHTML=`
        <div style="
            position: fixed;
            top: 20px;
            right: 20px;
            background: #e91e63;
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            z-index: 2000;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(233, 30, 99, 0.3);
            animation: slideIn 0.3s ease-out;
        ">
            🛒 ${e}
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},3e3)}function showWechatPayRedirect(){let e=document.createElement("div");e.className="wechat-pay-redirect",e.innerHTML=`
        <div style="
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            color: #333;
            padding: 2rem;
            border-radius: 12px;
            z-index: 3000;
            font-weight: 500;
            text-align: center;
            min-width: 300px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 2px solid #07c160;
        ">
            <div style="margin-bottom: 1rem; font-size: 1.2rem; color: #07c160;">💳 微信支付</div>
            <div style="margin-bottom: 1rem;">
                正在跳转到微信支付...
            </div>
            <div style="margin-bottom: 1rem; color: #666; font-size: 0.9rem;">
                请使用微信扫描二维码完成支付
            </div>
            <div style="
                width: 40px;
                height: 40px;
                border: 3px solid #07c160;
                border-top: 3px solid transparent;
                border-radius: 50%;
                animation: spin 1s linear infinite;
                margin: 0 auto;
            "></div>
        </div>
    `,document.body.appendChild(e),setTimeout(()=>{e.parentNode&&e.parentNode.removeChild(e)},3e3)}function showQRPopup(e){console.log("显示弹窗，金额：",e);var t=document.getElementById("popupOverlay");let o=document.getElementById("popupQR");document.getElementById("popupAmount").textContent="¥"+e;let n={5.88:"WechatIMG363.jpg",8.88:"3591759208694_.pic.jpg",10.88:"3601759208695_.pic.jpg",16.88:"3581759208690_.pic.jpg",28.88:"3611759208695_.pic.jpg"}[e]||"3591759208694_.pic.jpg";e=new Image;e.onload=function(){o.src=n,console.log("弹窗二维码已更新为：",n)},e.src=n,t.classList.add("show"),t.removeEventListener("click",handlePopupClick),t.addEventListener("click",handlePopupClick)}function handlePopupClick(e){e.target===document.getElementById("popupOverlay")&&closePopup()}function closePopup(){document.getElementById("popupOverlay").classList.remove("show")}function openCustomerService(){console.log("打开客服功能");var e=document.querySelector(".service-overlay");e&&e.remove(),closeAllMarketingPopups();let t=document.createElement("div");t.className="service-overlay",t.innerHTML=`
        <div class="service-popup">
            <div class="service-header">
                <h3>💬 客服助手</h3>
                <button class="service-close" onclick="closeService()">×</button>
            </div>
            <div class="service-messages">
                <div class="service-message bot">
                    <div class="message-avatar">🤖</div>
                    <div class="message-content">
                        请上传支付凭证，秒发您的套餐
                    </div>
                </div>
            </div>
            <div class="service-input">
                <input type="file" id="paymentProof" accept="image/*" style="display: none;" onchange="handleFileUpload(this)">
                <input type="text" id="messageInput" placeholder="输入消息..." style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 20px; outline: none;" onkeypress="handleKeyPress(event)">
                <button class="upload-btn" onclick="document.getElementById('paymentProof').click()">
                    📎 上传
                </button>
                <button class="send-btn" onclick="sendMessage()">
                    发送
                </button>
            </div>
        </div>
    `,document.body.appendChild(t),setTimeout(()=>{t.classList.add("show"),t.style.opacity="0",t.style.transform="scale(0.8)",setTimeout(()=>{t.style.opacity="1",t.style.transform="scale(1)"},50)},10)}function closeService(){let e=document.querySelector(".service-overlay");e&&(e.style.opacity="0",e.style.transform="scale(0.8)",setTimeout(()=>{e.remove()},200))}function handleFileUpload(e){let t=e.files[0];t&&((e=new FileReader).onload=function(e){addImageMessage(e.target.result,t.name)},e.readAsDataURL(t))}function addImageMessage(e,t){let o=document.querySelector(".service-messages");var n=document.createElement("div");n.className="service-message user",n.innerHTML=`
        <div class="message-content image-message">
            <div class="image-preview">
                <img src="${e}" alt="支付凭证" style="max-width: 200px; max-height: 200px; border-radius: 8px;">
            </div>
            <div class="file-info">📎 ${t}</div>
        </div>
        <div class="message-avatar">👤</div>
    `,o.appendChild(n),setTimeout(()=>{var e=document.createElement("div");e.className="service-message bot",e.innerHTML=`
            <div class="message-avatar">🤖</div>
            <div class="message-content">
                您的支付已收到，请添加QQ客服：<span class="qq-number">2458479270</span>
            </div>
        `,o.appendChild(e),o.scrollTop=o.scrollHeight},1e3),o.scrollTop=o.scrollHeight}function handleKeyPress(e){"Enter"===e.key&&sendMessage()}function sendMessage(){var e=document.getElementById("messageInput");if(e&&e.value.trim()){let t=document.querySelector(".service-messages");var o=document.createElement("div");o.className="service-message user",o.innerHTML=`
            <div class="message-content">
                ${e.value}
            </div>
            <div class="message-avatar">👤</div>
        `,t.appendChild(o),setTimeout(()=>{var e=document.createElement("div");e.className="service-message bot",e.innerHTML=`
                <div class="message-avatar">🤖</div>
                <div class="message-content">
                    请您上传支付凭证
                </div>
            `,t.appendChild(e),t.scrollTop=t.scrollHeight},1e3),e.value="",t.scrollTop=t.scrollHeight}}function initExitIntent(){console.log("初始化离开页面挽留弹窗...");let t=!1;document.addEventListener("mouseleave",function(e){e.clientY<=0&&!t&&setTimeout(()=>{showExitIntent(),t=!0},1e3)}),window.addEventListener("beforeunload",function(e){t||(showExitIntent(),t=!0)})}style.textContent=`
    @keyframes heartbeat {
        0% { transform: scale(1); }
        25% { transform: scale(1.1); }
        50% { transform: scale(1.05); }
        75% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }
    
    .amount-btn.active {
        background: #d63384;
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(233, 30, 99, 0.4);
    }
`,document.head.appendChild(style),document.addEventListener("DOMContentLoaded",addExtraFeatures),document.addEventListener("keydown",function(e){var t,o;"1"<=e.key&&e.key<="4"&&(t=document.querySelectorAll(".amount-btn"))[o=parseInt(e.key)-1]&&t[o].click()," "===e.key&&(document.getElementById("amount").textContent="0.00",document.querySelectorAll(".amount-btn").forEach(e=>e.classList.remove("active")),updatePaymentStatus("等待支付"))}),"ontouchstart"in window&&(document.addEventListener("touchstart",function(e){e.target.classList.contains("amount-btn")&&(e.target.style.transform="scale(0.95)")}),document.addEventListener("touchend",function(e){e.target.classList.contains("amount-btn")&&(e.target.style.transform="")}));let exitIntentShown=!1;function showExitIntent(){if(exitIntentShown)console.log("离开页面弹窗已显示，跳过重复显示");else{console.log("显示离开页面挽留弹窗");let e=document.getElementById("exitIntentOverlay");var t,o,n;e&&(t=document.getElementById("welcomePopup"),o=document.getElementById("timedPopupOverlay"),n=document.querySelector(".service-overlay"),t&&"none"!==t.style.display||o&&o.classList.contains("show")||n&&"none"!==n.style.display||(exitIntentShown=!0,e.classList.add("show"),e.style.opacity="0",e.style.transform="scale(0.8)",setTimeout(()=>{e.style.opacity="1",e.style.transform="scale(1)"},50)))}}function closeExitIntent(){console.log("关闭离开页面挽留弹窗");let e=document.getElementById("exitIntentOverlay");e&&(e.style.opacity="0",e.style.transform="scale(0.8)",setTimeout(()=>{e.classList.remove("show")},200))}function initPurchaseCounter(){console.log("初始化购买人数统计..."),setInterval(()=>{updatePurchaseStats()},3e4),updatePurchaseStats()}function updatePurchaseStats(){var e,t,o=document.getElementById("todayPurchases"),n=document.getElementById("monthPurchases");o&&(t=parseInt(o.textContent)||247,e=Math.floor(3*Math.random())+1,o.textContent=t+e),n&&(o=parseInt(n.textContent.replace(",",""))||1856,t=Math.floor(5*Math.random())+1,n.textContent=(o+t).toLocaleString())}let timedPopupInitialized=!1;function initTimedPopup(){timedPopupInitialized?console.log("限时弹窗已初始化，跳过重复初始化"):(console.log("初始化限时弹窗优惠..."),timedPopupInitialized=!0,setTimeout(()=>{showTimedPopup()},3e4))}let timedPopupShown=!1;function showTimedPopup(){timedPopupShown?console.log("限时弹窗已显示，跳过重复显示"):PopupManager.show("timed",()=>{console.log("显示限时弹窗优惠");let e=document.getElementById("timedPopupOverlay");e&&(timedPopupShown=!0,e.classList.add("show"),e.style.opacity="0",e.style.transform="scale(0.8)",setTimeout(()=>{e.style.opacity="1",e.style.transform="scale(1)",startTimedCountdown()},50))})}function closeTimedPopup(){console.log("关闭限时弹窗优惠");let e=document.getElementById("timedPopupOverlay");e&&(e.style.opacity="0",e.style.transform="scale(0.8)",setTimeout(()=>{e.classList.remove("show"),PopupManager.hide()},200))}function startTimedCountdown(){let o=300,n=document.getElementById("timedCountdown"),i=setInterval(()=>{var e=Math.floor(o/60),t=o%60;n&&(n.textContent=e.toString().padStart(2,"0")+":"+t.toString().padStart(2,"0")),--o<0&&(clearInterval(i),closeTimedPopup())},1e3)}function initScrollRewards(){console.log("初始化滚动进度奖励...");let t={25:!1,50:!1,75:!1,90:!1};window.addEventListener("scroll",()=>{var e=(window.pageYOffset||document.documentElement.scrollTop)/(document.documentElement.scrollHeight-window.innerHeight)*100;25<=e&&!t[25]&&(showScrollReward("恭喜！您已浏览25%内容，获得额外优惠券！"),t[25]=!0),50<=e&&!t[50]&&(showScrollReward("太棒了！您已浏览50%内容，享受VIP价格！"),t[50]=!0),75<=e&&!t[75]&&(showScrollReward("即将完成！您已浏览75%内容，获得专属服务！"),t[75]=!0),90<=e&&!t[90]&&(showScrollReward("完美！您已浏览90%内容，现在购买享受最大优惠！"),t[90]=!0)})}function showScrollReward(e){console.log("显示滚动奖励:",e);let t=document.createElement("div");t.className="scroll-reward",t.innerHTML=`
        <div class="reward-content">
            <span class="reward-icon">🎉</span>
            <span class="reward-text">${e}</span>
            <button class="reward-close" onclick="this.parentElement.parentElement.remove()">×</button>
        </div>
    `,t.style.cssText=`
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #4caf50, #45a049);
        color: white;
        padding: 15px 20px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        z-index: 10000;
        animation: slideInRight 0.5s ease;
        max-width: 300px;
    `,document.body.appendChild(t),setTimeout(()=>{t.parentElement&&t.remove()},5e3)}function initMarketingFeatures(){console.log("初始化营销功能..."),startCountdown(),initExitIntent(),initPurchaseCounter(),initScrollRewards(),animateSocialProof(),initMarketingFunnel(),manageScarcity()}function startCountdown(){console.log("开始初始化倒计时..."),setTimeout(()=>{let i=document.getElementById("hours"),a=document.getElementById("minutes"),s=document.getElementById("seconds");if(console.log("找到的元素:",{hoursElement:i,minutesElement:a,secondsElement:s}),i&&a&&s){let n=(new Date).getTime()+864e5;function e(){var e,t,o=(new Date).getTime(),o=n-o;0<o?(e=Math.floor(o/36e5),t=Math.floor(o%36e5/6e4),o=Math.floor(o%6e4/1e3),console.log(`倒计时更新: ${e}:${t}:`+o),i.textContent=e.toString().padStart(2,"0"),a.textContent=t.toString().padStart(2,"0"),s.textContent=o.toString().padStart(2,"0")):(console.log("倒计时结束，重置"),i.textContent="23",a.textContent="59",s.textContent="59")}console.log("倒计时结束时间:",new Date(n)),e(),setInterval(e,1e3)}else console.log("倒计时元素未找到，退出")},1e3)}function updatePurchaseCount(){let e=document.querySelectorAll(".stat"),t=12847;setInterval(()=>{Math.random()<.3&&(t+=Math.floor(3*Math.random())+1,e.forEach(e=>{e.textContent.includes("人购买")&&(e.innerHTML=`👥 已有 <strong>${t.toLocaleString()}</strong> 人购买`)}))},5e3)}function addUrgencyMessages(){let t=["🔥 限时特惠，错过再等一年！","⚡ 仅剩最后几个名额！","💎 新用户专享，立即抢购！","🎯 今日特价，明日恢复原价！"],o=0;setInterval(()=>{var e=document.querySelector(".urgency-text");e&&(e.textContent=t[o],o=(o+1)%t.length)},8e3)}function animateSocialProof(){document.querySelectorAll(".stat").forEach((e,t)=>{setTimeout(()=>{e.style.animation="bounce 0.6s ease-in-out",setTimeout(()=>{e.style.animation=""},600)},200*t)})}function enhanceButtonClicks(){document.querySelectorAll(".amount-btn").forEach(e=>{e.addEventListener("click",function(){this.style.transform="scale(0.95)",setTimeout(()=>{this.style.transform=""},150)})})}function initFeedbackCarousel(){}function generateFeedbackData(t,e){console.log("开始生成评价数据，数量:",t,"类型:",e);var o=["231","红","李","王","张","刘","陈","杨","黄","周","小吴","小郑","小何","小赵","小钱","小孙","小胡","小朱","小高","小林","小徐","小马","小郭","小罗","小梁","小宋","小唐","小许","小韩","小冯","小邓","小曹","小彭","小曾","小萧","小田","小董","小袁","小潘","小于","小蒋","小蔡","小余","小杜","小叶","小程","小苏","小魏","小吕","小丁"],n=["👤","👨","👩","🧑","👦","👧","👶","👴","👵","👱","👲","👳"],i=["服务态度很好，回复及时","图片清晰，内容精彩","性价比很高，推荐购买","客服很专业，问题解决很快","内容更新及时，质量稳定","价格合理，服务周到","购买流程简单，体验很好","内容丰富多样，值得推荐","客服态度友好，很有耐心","内容质量超出预期","服务专业，值得信赖","购买后立即发货，效率很高","内容真实，没有虚假宣传","客服回复及时，解决问题快","价格公道，性价比很高","内容丰富，更新频率高","服务态度好，体验很棒","内容质量稳定，值得购买","客服专业，服务周到","购买流程顺畅，体验良好","服务效率高，回复及时","价格合理，质量保证","内容丰富，满足需求","客服态度好，解决问题快","内容更新及时，质量稳定","服务专业，值得推荐","购买体验很好，会再次购买","内容真实可靠，没有失望","客服回复快，服务周到","价格公道，性价比高","内容丰富多样，质量很好","服务态度友好，体验不错","内容质量超出预期，很满意","客服专业，问题解决及时","购买流程简单，发货快速","内容精彩，值得购买","服务效率高，态度很好","价格合理，质量保证","内容丰富，更新及时","客服回复及时，服务专业","内容真实，没有虚假","服务周到，体验良好","价格公道，性价比很高","内容丰富多样，质量稳定","客服态度好，解决问题快","内容更新及时，质量保证","服务专业，值得信赖","购买体验很好，推荐购买"],a=["⭐⭐⭐⭐⭐","⭐⭐⭐⭐⭐","⭐⭐⭐⭐⭐","⭐⭐⭐⭐⭐","⭐⭐⭐⭐⭐"],s=[];for(let e=0;e<t;e++){var r=o[Math.floor(Math.random()*o.length)],l=n[Math.floor(Math.random()*n.length)],d=i[Math.floor(Math.random()*i.length)],c=a[Math.floor(Math.random()*a.length)];s.push({name:r+(Math.floor(999*Math.random())+1),avatar:l,text:d,rating:c})}return console.log("评价数据生成完成，共",s.length,"条"),s}function initHistoricalFeedback(){console.log("开始初始化历史评价...");let t=document.getElementById("historicalTrack");var e,o;t?(console.log("找到historicalTrack元素"),e=generateFeedbackData(100,"historical"),console.log("生成了",e.length,"条评价数据"),e=e.map(e=>`
        <div class="feedback-item" onclick="showFeedbackDetail(this)">
            <div class="user-avatar">${e.avatar}</div>
            <div class="feedback-content">
                <div class="user-name">${e.name}</div>
                <div class="feedback-text">"${e.text}"</div>
                <div class="feedback-rating">${e.rating}</div>
            </div>
        </div>
    `).join(""),console.log("强制替换所有内容，生成200条评价"),t.innerHTML=e,console.log("历史评价HTML已插入"),e=t.querySelectorAll(".feedback-item"),console.log("找到",e.length,"个反馈项"),e.forEach(e=>{e=e.cloneNode(!0);t.appendChild(e)}),console.log("复制完成，现在有",t.querySelectorAll(".feedback-item").length,"个反馈项"),(o=document.getElementById("historicalFeedback"))&&(o.addEventListener("mouseenter",function(){t.style.animationPlayState="paused"}),o.addEventListener("mouseleave",function(){t.style.animationPlayState="running"})),o=80*e.length,t.style.height=o+"px",console.log("设置容器高度为:",o+"px")):console.log("未找到historicalTrack元素")}function initTodayFeedback(){console.log("开始初始化今日评价...");let t=document.getElementById("todayTrack");var e,o;t?(console.log("找到todayTrack元素"),e=generateFeedbackData(30,"today"),console.log("生成了",e.length,"条今日评价数据"),e=e.map(e=>`
        <div class="today-feedback-item" onclick="showTodayFeedbackDetail(this)">
            <div class="today-user-avatar">${e.avatar}</div>
            <div class="today-feedback-content">
                <div class="today-user-name">${e.name}</div>
                <div class="today-feedback-text">"${e.text}"</div>
                <div class="today-feedback-rating">${e.rating}</div>
            </div>
        </div>
    `).join(""),console.log("强制替换今日评价内容，生成50条评价"),t.innerHTML=e,console.log("今日评价HTML已插入"),e=t.querySelectorAll(".today-feedback-item"),console.log("找到",e.length,"个今日反馈项"),e.forEach(e=>{e=e.cloneNode(!0);t.appendChild(e)}),console.log("今日评价复制完成，现在有",t.querySelectorAll(".today-feedback-item").length,"个反馈项"),(o=document.getElementById("todayFeedback"))&&(o.addEventListener("mouseenter",function(){t.style.animationPlayState="paused"}),o.addEventListener("mouseleave",function(){t.style.animationPlayState="running"})),o=60*e.length,t.style.height=o+"px",console.log("设置今日评价容器高度为:",o+"px")):console.log("未找到todayTrack元素")}function showTodayFeedbackDetail(e){var t=e.querySelector(".today-user-name").textContent,e=e.querySelector(".today-feedback-text").textContent;let o=document.createElement("div");o.style.cssText=`
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        animation: fadeIn 0.3s ease-in-out;
    `,o.innerHTML=`
        <div style="
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.4s ease-out;
        ">
            <div style="
                width: 60px;
                height: 60px;
                background: linear-gradient(135deg, #ff6b9d, #e91e63);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                color: white;
                margin: 0 auto 20px;
            ">👤</div>
            <h3 style="color: #d63384; margin-bottom: 15px; font-size: 1.2rem;">${t}</h3>
            <p style="color: #666; font-size: 1rem; line-height: 1.5; margin-bottom: 15px; font-style: italic;">"${e}"</p>
            <div style="color: #ffd700; font-size: 1.2rem; margin-bottom: 20px;">⭐⭐⭐⭐⭐</div>
            <button onclick="this.parentElement.parentElement.remove()" style="
                background: linear-gradient(135deg, #ff6b9d, #e91e63);
                color: white;
                border: none;
                padding: 10px 25px;
                border-radius: 20px;
                font-size: 0.9rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            ">关闭</button>
        </div>
    `,document.body.appendChild(o),o.addEventListener("click",function(e){e.target===o&&o.remove()})}function showFeedbackDetail(e){var t=e.querySelector(".user-name").textContent,e=e.querySelector(".feedback-text").textContent;let o=document.createElement("div");o.style.cssText=`
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        animation: fadeIn 0.3s ease-in-out;
    `,o.innerHTML=`
        <div style="
            background: white;
            border-radius: 15px;
            padding: 30px;
            max-width: 400px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.4s ease-out;
        ">
            <div style="
                width: 60px;
                height: 60px;
                background: linear-gradient(135deg, #ff6b9d, #e91e63);
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.5rem;
                color: white;
                margin: 0 auto 20px;
            ">👤</div>
            <h3 style="color: #d63384; margin-bottom: 15px; font-size: 1.2rem;">${t}</h3>
            <p style="color: #666; font-size: 1rem; line-height: 1.5; margin-bottom: 15px; font-style: italic;">"${e}"</p>
            <div style="color: #ffd700; font-size: 1.2rem; margin-bottom: 20px;">⭐⭐⭐⭐⭐</div>
            <button onclick="this.parentElement.parentElement.remove()" style="
                background: linear-gradient(135deg, #ff6b9d, #e91e63);
                color: white;
                border: none;
                padding: 10px 25px;
                border-radius: 20px;
                font-size: 0.9rem;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s ease;
            ">关闭</button>
        </div>
    `,document.body.appendChild(o),o.addEventListener("click",function(e){e.target===o&&o.remove()})}document.addEventListener("DOMContentLoaded",enhanceButtonClicks);let marketingFunnelInitialized=!1;function initMarketingFunnel(){marketingFunnelInitialized?console.log("营销漏斗已初始化，跳过重复初始化"):(console.log("初始化营销漏斗..."),marketingFunnelInitialized=!0,updateFunnelSteps())}let PopupManager={currentPopup:null,isTransitioning:!1,show(e,t){this.isTransitioning||this.currentPopup===e||(this.isTransitioning=!0,this.currentPopup=e,t&&t(),setTimeout(()=>{this.isTransitioning=!1},500))},hide(){this.currentPopup=null,this.isTransitioning=!1}};function startMarketingGuidance(){console.log("开始营销引导..."),highlightRecommendedPackage(),showGuidanceTips(),trackUserBehavior(),setTimeout(()=>{PopupManager.currentPopup||initTimedPopup()},8e3)}function highlightRecommendedPackage(){var e=document.querySelector(".amount-btn.best-value");e&&(e.style.animation="pulse 2s infinite",e.style.transform="scale(1.05)")}function showGuidanceTips(){let e=["💡 推荐选择¥100套餐，性价比最高！","🎯 已有2,847人选择此套餐，好评如潮！","⚡ 限时特价，错过再等一年！","💎 全套打包，一次购买终身享受！"],t=0;setInterval(()=>{showFloatingTip(e[t]),t=(t+1)%e.length},1e4)}function showFloatingTip(e){let t=document.createElement("div");t.textContent=e,t.style.cssText=`
        position: fixed;
        top: 80px;
        right: 20px;
        background: linear-gradient(135deg, #ff6b9d, #e91e63);
        color: white;
        padding: 12px 20px;
        border-radius: 25px;
        font-size: 14px;
        font-weight: 600;
        z-index: 9999;
        box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
        animation: slideIn 0.5s ease-out;
        max-width: 300px;
    `,document.body.appendChild(t),setTimeout(()=>{t.remove()},4e3)}function updateFunnelSteps(){document.querySelectorAll(".step")[0].classList.add("active")}function closeAllMarketingPopups(){console.log("关闭所有营销弹窗...");let e=document.getElementById("timedPopupOverlay"),t=(e&&e.classList.contains("show")&&(e.style.opacity="0",setTimeout(()=>{e.classList.remove("show")},200)),document.getElementById("exitIntentOverlay")),o=(t&&t.classList.contains("show")&&(t.style.opacity="0",setTimeout(()=>{t.classList.remove("show")},200)),document.querySelector(".service-overlay"));o&&(o.style.opacity="0",setTimeout(()=>{o.remove()},200))}function selectPackage(e,t){console.log("选择套餐：",e,t),closeAllMarketingPopups(),updateFunnelStep(2),updateScarcity(e),generateWechatQRCode(e);t=document.getElementById("amount");t&&(t.textContent=e),showQRPopup(e)}function updateFunnelStep(o){document.querySelectorAll(".step").forEach((e,t)=>{e.classList.remove("active"),t<o&&e.classList.add("active")})}function manageScarcity(){let t=document.getElementById("remainingSpots");if(t){let e=11;setInterval(()=>{Math.random()<.1&&1<e&&(e--,(t.textContent=e)<=5)&&showScarcityAlert()},8e3)}}function updateScarcity(e){var t,o=document.getElementById("remainingSpots");o&&0<(t=parseInt(o.textContent))&&(o.textContent=--t)}function showScarcityAlert(){let e=document.createElement("div");e.innerHTML=`
        <div style="
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff5722, #f44336);
            color: white;
            padding: 15px 25px;
            border-radius: 25px;
            text-align: center;
            z-index: 10000;
            box-shadow: 0 8px 25px rgba(255, 87, 34, 0.4);
            animation: pulse 1s infinite;
        ">
            <div style="font-size: 1rem; font-weight: bold;">
                ⚠️ 名额即将售罄！
            </div>
            <div style="font-size: 0.9rem;">
                仅剩最后几个名额，立即抢购！
            </div>
        </div>
    `,document.body.appendChild(e),setTimeout(()=>{e.remove()},5e3)}function addBehavioralNudges(){let e=0,t=Date.now();document.addEventListener("mousemove",()=>{t=Date.now(),e=0}),setInterval(()=>{3e4<(e=Date.now()-t)&&(showIdleGuidance(),t=Date.now())},5e3)}function showIdleGuidance(){let e=document.createElement("div");e.innerHTML=`
        <div style="
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(135deg, #ff6b9d, #e91e63);
            color: white;
            padding: 15px 20px;
            border-radius: 25px;
            text-align: center;
            z-index: 10000;
            box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
            animation: bounce 0.6s ease-in-out;
            max-width: 250px;
        ">
            <div style="font-size: 0.9rem; font-weight: bold; margin-bottom: 5px;">
                💡 还在犹豫吗？
            </div>
            <div style="font-size: 0.8rem;">
                限时特惠，错过再等一年！
            </div>
        </div>
    `,document.body.appendChild(e),setTimeout(()=>{e.remove()},4e3)}function trackUserBehavior(){let e=0,t=0;window.addEventListener("scroll",()=>{e=Math.max(e,window.scrollY/(document.body.scrollHeight-window.innerHeight))}),setInterval(()=>{60<++t&&e<.5&&showScrollGuidance()},1e3)}function showScrollGuidance(){let e=document.createElement("div");e.innerHTML=`
        <div style="
            position: fixed;
            bottom: 80px;
            right: 20px;
            background: linear-gradient(135deg, #2196f3, #1976d2);
            color: white;
            padding: 12px 18px;
            border-radius: 20px;
            text-align: center;
            z-index: 10000;
            box-shadow: 0 6px 20px rgba(33, 150, 243, 0.4);
            animation: float 2s ease-in-out infinite;
        ">
            <div style="font-size: 0.8rem; font-weight: bold;">
                👆 向下滚动查看更多
            </div>
        </div>
    `,document.body.appendChild(e),setTimeout(()=>{e.remove()},3e3)}